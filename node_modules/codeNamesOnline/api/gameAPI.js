'use strict';

//==============================================================================
//  Modules
//==============================================================================

var gameManager = require('codeNamesOnline/gameManager');
var Player      = require('codeNamesOnline/player');

//==============================================================================
//  Exports
//==============================================================================


module.exports.CreateNewGame = function (callback) {
	gameManager.CreateNewGame(function (error, gameCode) {
		if (error) {
			return callback(error);
		}
		else {
			return callback(null, gameCode);
		}
	});
};

module.exports.AddSocket = function (gameCode, socket, callback) {
	try {
		gameManager.AddSocket(gameCode, socket);
	}
	catch (ex) {
		return callback(ex);
	}
	return callback();
};

module.exports.GetGameData = function (gameCode, callback) {
	try {
		var gameData = gameManager.GetGameData(gameCode);
	}
	catch (ex) {
		return callback(ex);
	}
	return callback(null, gameData);
};

module.exports.AddPlayer = function (gameCode, playerDataJSON, callback) {
	try {
		var playerData = JSON.parse(playerDataJSON);
		var name = playerData.name;
		var team = playerData.team;
		var player = new Player(name, team);
		gameManager.AddPlayer(gameCode, player);
	}
	catch (ex) {
		return callback(ex);
	}
	return callback();
};
